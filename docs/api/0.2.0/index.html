<!DOCTYPE html> <html lang="en-US"> <!-- Copied and modified: /jekyll/gems/ruby/2.7.0/gems/just-the-docs-0.3.3/_includes/head.html Least impact way of adding different javascript libraries to various pages --> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>api_0.2.0 - Metapages</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="https://unpkg.com/mermaid@8.2.6/dist/mermaid.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>api_0.2.0 | Metapages</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="api_0.2.0" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="API Reference v0.2.0" /> <meta property="og:description" content="API Reference v0.2.0" /> <link rel="canonical" href="https://metapages.org/api/0.2.0/" /> <meta property="og:url" content="https://metapages.org/api/0.2.0/" /> <meta property="og:site_name" content="Metapages" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2024-02-18T15:03:25-06:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="api_0.2.0" /> <script type="application/ld+json"> {"url":"https://metapages.org/api/0.2.0/","@type":"BlogPosting","description":"API Reference v0.2.0","mainEntityOfPage":{"@type":"WebPage","@id":"https://metapages.org/api/0.2.0/"},"headline":"api_0.2.0","dateModified":"2024-02-18T15:03:25-06:00","datePublished":"2024-02-18T15:03:25-06:00","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://metapages.org/" class="site-title lh-tight"> Metapages </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://metapages.org/" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://metapages.org/documentation/" class="nav-list-link">Documentation</a><ul class="nav-list "><li class="nav-list-item "><a href="https://metapages.org/pages/documentation/01-use-cases.html" class="nav-list-link">Use cases</a></li><li class="nav-list-item "><a href="https://metapages.org/pages/documentation/02-creating.html" class="nav-list-link">Creating a metapage</a></li><li class="nav-list-item "><a href="https://metapages.org/pages/documentation/03_data-flow.html" class="nav-list-link">Data Flow</a></li></ul></li><li class="nav-list-item"><a href="https://metapages.org/api/" class="nav-list-link">API</a></li><li class="nav-list-item"><a href="https://metapages.org/examples/" class="nav-list-link">Examples</a></li><li class="nav-list-item"><a href="https://metapages.org/install/" class="nav-list-link">Install/Download</a></li><li class="nav-list-item"><a href="https://metapages.org/tools/" class="nav-list-link">Tools</a></li><li class="nav-list-item"><a href="https://metapages.org/plugins/" class="nav-list-link">Plugins</a></li><li class="nav-list-item"><a href="https://metapages.org/test/" class="nav-list-link">Test</a></li><li class="nav-list-item"><a href="https://metapages.org/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/metapages/metapage" class="site-button" > GitHub </a> </li> <li class="aux-nav-list-item"> <a href="//www.npmjs.com/package/metapage" class="site-button" > npm </a> </li> <li class="aux-nav-list-item"> <a href="//app.metapages.org/" class="site-button" > Metapage Viewer </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 id="api-reference-v020"> <a href="#api-reference-v020" class="anchor-heading" aria-labelledby="api-reference-v020"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> API Reference v0.2.0 </h1> <hr /> <h2 id="metapagedefinition"> <a href="#metapagedefinition" class="anchor-heading" aria-labelledby="metapagedefinition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MetapageDefinition<a name="metapagedefinition"></a> </h2> <p>The JSON description consists of metaframes and the metaframe inputs.</p> <p>Example minimal metapage with two metaframes:</p> <div class="language-mermaid">graph LR metaframe1 -- "output1 -&gt; input1" --&gt; metaframe2 metaframe2 -- "data-stream" --&gt; metaframe1 </div> <p>Defined by:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.2"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"metaframes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"metaframe1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://metapages.org/metaframes/example00_iframe1/"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"metaframe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metaframe2"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"source"</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="s2">"output1"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"target"</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="s2">"input1"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"metaframe2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://metapages.org/metaframes/example00_iframe2/"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"metaframe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"metaframe1"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"source"</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class="s2">"data-stream"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <!-- {: .fs-5 .ls-10 .text-mono .code-example } --> <p>The <code class="language-plaintext highlighter-rouge">target</code> key of the <code class="language-plaintext highlighter-rouge">inputs</code> array element can be omitted if the value is the same as the <code class="language-plaintext highlighter-rouge">source</code> value.</p> <p><code class="language-plaintext highlighter-rouge">version</code>: This library hasn’t reached version <code class="language-plaintext highlighter-rouge">"1"</code> yet. Backwards compatibility is built into this library from it’s first release, and will be automated as much as possible. This is required to maintain long-term compatibility: metaframes should be useful forever, if that is possible from the content. Users should only need to upgrade for bug fixes, performance improvements, or to access new features, and there should never be cognitive load (no worries) about versioning for library users. Mistakes happen, no process is perfect, but this tool assumes the burden of handling all changes to versions over time.</p><hr /> <h2 id="metapage"> <a href="#metapage" class="anchor-heading" aria-labelledby="metapage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage </h2> <p>A metapage manages piping metaframe outputs to metaframe inputs.</p> <p>Ways to initialize a metapage:</p> <ol> <li>Create a metapage from a <a href="#metapagedefinition">MetapageDefinition</a> JSON object: <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">metapage</span> <span class="o">=</span> <span class="nx">Metapage</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">def</span> <span class="p">:</span><span class="nx">MetapageDefinition</span><span class="p">,</span> <span class="p">?</span><span class="nx">opts</span> <span class="p">:</span><span class="nx">Options</span><span class="p">):</span> <span class="nx">Metapage</span>
</code></pre></div> </div> </li> <li>Create an empty metapage via the constructor. Metaframes and pipes are added manually. This is mostly used for testing or debugging: <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">metapage</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Metapage</span><span class="p">(?</span><span class="nx">opts</span> <span class="p">:</span><span class="nx">Options</span><span class="p">):</span> <span class="nx">Metapage</span>
</code></pre></div> </div> </li> </ol> <p>The optional <code class="language-plaintext highlighter-rouge">opts</code> argument defineds some extra options, mostly used for debugging:</p> <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">Options</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">?:</span> <span class="nb">String</span><span class="p">;</span>  <span class="c1">// Color of console.logs, since all iframes and the main page will output logs to the same console</span>
  <span class="nl">id</span><span class="p">?</span>   <span class="p">:</span> <span class="nb">String</span><span class="p">;</span>  <span class="c1">//Id, not required, but useful if you have multiple metapages in a single website.</span>
<span class="p">}</span>
</code></pre></div></div> <p>If the URL has the parameter <code class="language-plaintext highlighter-rouge">MP_DEBUG</code> then debug logging is enabled: <code class="language-plaintext highlighter-rouge">https://domain.org/metapage1?MP_DEBUG</code></p> <h3 id="metapageaddmetaframe"> <a href="#metapageaddmetaframe" class="anchor-heading" aria-labelledby="metapageaddmetaframe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#addMetaframe </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">addMetaframe</span><span class="p">(</span><span class="nx">url</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="p">?</span><span class="nx">iframeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">):</span> <span class="nx">MetaframeClient</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">url</code>: URL to a metaframe website</p> <p><code class="language-plaintext highlighter-rouge">iframeId</code>: optional</p> <p>Add a new metaframe using the URL. Optionally provide a (locally unique to the metapage) id. If an id is not provided, one will be generated.</p> <h3 id="metapageaddpipe"> <a href="#metapageaddpipe" class="anchor-heading" aria-labelledby="metapageaddpipe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#addPipe </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">addPipe</span><span class="p">(</span><span class="nx">targetMetaframe</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="nx">pipeInput</span> <span class="p">:</span><span class="nx">PipeInput</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">targetMetaframe</code>: metaframeId of the target metaframe</p> <p><code class="language-plaintext highlighter-rouge">pipeInput</code>: object describing the source metaframe, output pipe name, and input pipe name</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">metaframe</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;sourceMetaframeId&gt;</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">source</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;sourceMetaframePipeName&gt;</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">target</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;thisMetaframePipeName&gt;</span><span class="dl">"</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">pipeInput.metaframe</code>: source metaframeId</p> <p><code class="language-plaintext highlighter-rouge">pipeInput.source</code>: source metaframe output pipe name. Can be <code class="language-plaintext highlighter-rouge">*</code> or any glob, this will forward all output pipes matching the glob</p> <p><code class="language-plaintext highlighter-rouge">pipeInput.target</code>: target metaframe input pipe name. If <code class="language-plaintext highlighter-rouge">target</code> is omitted, then the input pipe name will be the same as the output pipe name.</p> <p>Add a new metaframe input pipe, from the source metaframes output <code class="language-plaintext highlighter-rouge">source</code>, to the target metaframes <code class="language-plaintext highlighter-rouge">target</code> input.</p> <div class="language-mermaid">graph LR metaframeSource[pipeInput.metaframe] -- "pipeInput.source -&gt; pipeInput.target" --&gt; targetMetaframe </div> <h3 id="metapagedispose"> <a href="#metapagedispose" class="anchor-heading" aria-labelledby="metapagedispose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#dispose </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">dispose</span><span class="p">()</span>
</code></pre></div></div> <p>Removes all metaframes, window listeners, event listeners.</p> <h3 id="metapageget"> <a href="#metapageget" class="anchor-heading" aria-labelledby="metapageget"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#get </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">):</span> <span class="nx">MetaframeClient</span>
</code></pre></div></div> <p>Get the MetaframeClient for the given id.</p> <h3 id="metapageiframes"> <a href="#metapageiframes" class="anchor-heading" aria-labelledby="metapageiframes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#iframes </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">iframes</span><span class="p">():</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span> <span class="nx">IFrameElement</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns a plain Object with metaframe ids mapped to the underlying metaframe <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe">iframes</a>.</p> <h3 id="metapagemetaframeids"> <a href="#metapagemetaframeids" class="anchor-heading" aria-labelledby="metapagemetaframeids"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#metaframeIds </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">metaframeIds</span><span class="p">():</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns an array of metaframe ids.</p> <h3 id="metapagemetaframes"> <a href="#metapagemetaframes" class="anchor-heading" aria-labelledby="metapagemetaframes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#metaframes </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">metaframes</span><span class="p">():</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span> <span class="nx">MetaframeClient</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns a plain Object with metaframe ids mapped to MetaframeClient objects.</p> <h3 id="metapageoninputs"> <a href="#metapageoninputs" class="anchor-heading" aria-labelledby="metapageoninputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#onInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">onInputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every input update event. Example <code class="language-plaintext highlighter-rouge">inputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">metaframeId1</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">inputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>You can also listen on the metaframe clients directly:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h3 id="metapageonoutputs"> <a href="#metapageonoutputs" class="anchor-heading" aria-labelledby="metapageonoutputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#onOutputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">onOutputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every output update event. Example <code class="language-plaintext highlighter-rouge">outputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">metaframeId1</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">outputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>You can also listen on the metaframe clients directly:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h3 id="metapageremoveall"> <a href="#metapageremoveall" class="anchor-heading" aria-labelledby="metapageremoveall"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#removeAll </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">removeAll</span><span class="p">()</span>
</code></pre></div></div> <p>Removes all metaframes, essentially resetting the metapage. It doesn’t remove window listeners though, for proper disposal call <code class="language-plaintext highlighter-rouge">dispose()</code>.</p> <h3 id="metapagesetinputsetinputs"> <a href="#metapagesetinputsetinputs" class="anchor-heading" aria-labelledby="metapagesetinputsetinputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#setInput/setInputs </h3> <p>Set metaframe inputs a variety of ways (there is no difference between <code class="language-plaintext highlighter-rouge">setInput/setInputs</code> calls).</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="nx">metaframeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="nx">inputPipeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="nx">value</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="nx">metaframeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="nx">inputsObject</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="nx">metaframeInputsObject</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">inputsObject</code>:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">inputPipeName</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">some value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">metaframeInputsObject</code>:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">metaframeId</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">inputPipeName</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">some value</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="metapage-events"> <a href="#metapage-events" class="anchor-heading" aria-labelledby="metapage-events"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage events </h3> <p>Metapage event allows you to add hooks to the data flow:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Example update:
 * {
 *   "metaframe1": {
 *     "input1": "foobar",
 *     "input2": 3
 *   }
 * }
 */</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">update</span><span class="p">)</span> <span class="p">{</span>

<span class="p">});</span>
</code></pre></div></div> <p>Listens to changes in the <code class="language-plaintext highlighter-rouge">inputs</code> for metaframes. The listener is called on every discrete input update.</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Example update:
 * {
 *   "metaframe1": {
 *     "output1": "foobar",
 *     "output2": 3
 *   }
 * }
 */</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">update</span><span class="p">)</span> <span class="p">{</span>

<span class="p">});</span>
</code></pre></div></div> <p>Listens to changes in the <code class="language-plaintext highlighter-rouge">outputs</code> for metaframes. The listener is called on every discrete output update.</p> <p>You can also just listen to a specific metaframe client:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Example update:
 * {
*    "output1": "foobar",
 * }
 */</span>
<span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">update</span><span class="p">)</span> <span class="p">{</span>

<span class="p">});</span>
</code></pre></div></div> <h3 id="metapagemetaframeclient"> <a href="#metapagemetaframeclient" class="anchor-heading" aria-labelledby="metapagemetaframeclient"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient </h3> <p>An internal object managing the data flow in and out of the actual metaframe iframe. You shouldn’t need to access this object directly. This object is in the <em>metapage</em> page, managing the metaframe data flow.</p> <h3 id="metapagemetaframeclientiframe"> <a href="#metapagemetaframeclientiframe" class="anchor-heading" aria-labelledby="metapagemetaframeclientiframe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#iframe </h3> <p>The concrete metaframe <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe">iframe</a> HTML element.</p> <h3 id="metapagemetaframeclientdispose"> <a href="#metapagemetaframeclientdispose" class="anchor-heading" aria-labelledby="metapagemetaframeclientdispose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#dispose </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">dispose</span><span class="p">()</span>
</code></pre></div></div> <p>Removes all event listeners and clears internal objects.</p> <h3 id="metapagemetaframeclientoninputs"> <a href="#metapagemetaframeclientoninputs" class="anchor-heading" aria-labelledby="metapagemetaframeclientoninputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#onInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">onInputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every input update event. Example <code class="language-plaintext highlighter-rouge">inputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">inputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h3 id="metapagemetaframeclientonoutputs"> <a href="#metapagemetaframeclientonoutputs" class="anchor-heading" aria-labelledby="metapagemetaframeclientonoutputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#onOutputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">onOutputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every output update event. Example <code class="language-plaintext highlighter-rouge">outputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">outputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h2 id="metaframe"> <a href="#metaframe" class="anchor-heading" aria-labelledby="metaframe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe </h2> <p>A metaframe is a website running the metaframe library that adds input+output data pipes to the page.</p> <p>Initialize a metaframe:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">metaframe</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Metaframe</span><span class="p">();</span>
</code></pre></div></div> <p>Wait until it has registered and established a connection with the parent <em>metapage</em>:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">ready</span>
</code></pre></div></div> <p>or:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">ready</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">//Do something, set inputs/outputs</span>
<span class="p">});</span>
</code></pre></div></div> <h3 id="metaframename"> <a href="#metaframename" class="anchor-heading" aria-labelledby="metaframename"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#name </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">s</span> <span class="p">:</span><span class="nb">String</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</code></pre></div></div> <p>The id the metapage assigned to this metaframe. Defaults to the key in the metapage definition.</p> <h3 id="metaframegetinput"> <a href="#metaframegetinput" class="anchor-heading" aria-labelledby="metaframegetinput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getInput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">inputValue</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getInput</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputName</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div> <h3 id="metaframegetinputs"> <a href="#metaframegetinputs" class="anchor-heading" aria-labelledby="metaframegetinputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">inputValues</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getInputs</span><span class="p">()</span>
</code></pre></div></div> <p>Get a object of input pipe names mapped to values.</p> <p>Do not modify the returned object! For efficiency purposes this is <em>not</em> a copy.</p> <h3 id="metaframegetoutput"> <a href="#metaframegetoutput" class="anchor-heading" aria-labelledby="metaframegetoutput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getOutput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getOutput</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputName</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div> <h3 id="metaframegetoutputs"> <a href="#metaframegetoutputs" class="anchor-heading" aria-labelledby="metaframegetoutputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getOutputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">outputs</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getOutputs</span><span class="p">()</span>
</code></pre></div></div> <p>Do not modify the returned object! For efficiency purposes this is <em>not</em> a copy.</p> <h3 id="metaframeoninputs"> <a href="#metaframeoninputs" class="anchor-heading" aria-labelledby="metaframeoninputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#onInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">onInputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every input update event. Example <code class="language-plaintext highlighter-rouge">inputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">inputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>Do not modify the returned object! For efficiency purposes this is <em>not</em> a copy.</p> <p>An unbind function is returned.</p> <h3 id="metaframeoninput"> <a href="#metaframeoninput" class="anchor-heading" aria-labelledby="metaframeoninput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#onInput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">onInput</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputName</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>The callback will fire with the value of the input pipe on every update.</p> <p>An unbind function is returned.</p> <h3 id="metaframesetinput"> <a href="#metaframesetinput" class="anchor-heading" aria-labelledby="metaframesetinput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#setInput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputName</span><span class="dl">'</span><span class="p">,</span> <span class="nx">value</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
</code></pre></div></div> <h3 id="metaframesetoutput"> <a href="#metaframesetoutput" class="anchor-heading" aria-labelledby="metaframesetoutput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#setOutput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">setOutput</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputName</span><span class="dl">'</span><span class="p">,</span> <span class="nx">value</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
</code></pre></div></div> <p>This value will be send to all downstream metaframe consumers.</p> <h3 id="metaframesetoutput-1"> <a href="#metaframesetoutput-1" class="anchor-heading" aria-labelledby="metaframesetoutput-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#setOutput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">setOutputs</span><span class="p">(</span><span class="nx">values</span> <span class="p">:</span><span class="nb">Object</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">values</code>: object mapping output names to values.</p> <p>These values will be send to all downstream metaframe consumers.</p> </div> </div> </div> </body> </html>
