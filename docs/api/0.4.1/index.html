<!DOCTYPE html> <html lang="en-US"> <!-- Copied and modified: /jekyll/gems/ruby/2.7.0/gems/just-the-docs-0.3.3/_includes/head.html Least impact way of adding different javascript libraries to various pages --> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>API - Metapages</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="https://unpkg.com/mermaid@8.2.6/dist/mermaid.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>API | Metapages</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="API" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="API Reference v0.4.1" /> <meta property="og:description" content="API Reference v0.4.1" /> <link rel="canonical" href="https://metapages.org/api/0.4.1/" /> <meta property="og:url" content="https://metapages.org/api/0.4.1/" /> <meta property="og:site_name" content="Metapages" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2024-02-18T15:03:25-06:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="API" /> <script type="application/ld+json"> {"url":"https://metapages.org/api/0.4.1/","@type":"BlogPosting","description":"API Reference v0.4.1","mainEntityOfPage":{"@type":"WebPage","@id":"https://metapages.org/api/0.4.1/"},"headline":"API","dateModified":"2024-02-18T15:03:25-06:00","datePublished":"2024-02-18T15:03:25-06:00","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://metapages.org/" class="site-title lh-tight"> Metapages </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="https://metapages.org/" class="nav-list-link">Introduction</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://metapages.org/documentation/" class="nav-list-link">Documentation</a><ul class="nav-list "><li class="nav-list-item "><a href="https://metapages.org/pages/documentation/01-use-cases.html" class="nav-list-link">Use cases</a></li><li class="nav-list-item "><a href="https://metapages.org/pages/documentation/02-creating.html" class="nav-list-link">Creating a metapage</a></li><li class="nav-list-item "><a href="https://metapages.org/pages/documentation/03_data-flow.html" class="nav-list-link">Data Flow</a></li></ul></li><li class="nav-list-item"><a href="https://metapages.org/api/" class="nav-list-link">API</a></li><li class="nav-list-item"><a href="https://metapages.org/examples/" class="nav-list-link">Examples</a></li><li class="nav-list-item"><a href="https://metapages.org/install/" class="nav-list-link">Install/Download</a></li><li class="nav-list-item"><a href="https://metapages.org/tools/" class="nav-list-link">Tools</a></li><li class="nav-list-item"><a href="https://metapages.org/plugins/" class="nav-list-link">Plugins</a></li><li class="nav-list-item"><a href="https://metapages.org/test/" class="nav-list-link">Test</a></li><li class="nav-list-item"><a href="https://metapages.org/about/" class="nav-list-link">About</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/metapages/metapage" class="site-button" > GitHub </a> </li> <li class="aux-nav-list-item"> <a href="//www.npmjs.com/package/metapage" class="site-button" > npm </a> </li> <li class="aux-nav-list-item"> <a href="//app.metapages.org/" class="site-button" > Metapage Viewer </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="api-reference-v041"> <a href="#api-reference-v041" class="anchor-heading" aria-labelledby="api-reference-v041"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> API Reference v0.4.1 </h1> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents </h2> <ol id="markdown-toc"> <li><a href="#metapagedefinition" id="markdown-toc-metapagedefinition">MetapageDefinition<a name="metapagedefinition"></a></a></li> <li><a href="#metapage" id="markdown-toc-metapage">Metapage</a> <ol> <li><a href="#metapagesetdebugfromurlparams" id="markdown-toc-metapagesetdebugfromurlparams">Metapage#setDebugFromUrlParams</a></li> <li><a href="#metapagedispose" id="markdown-toc-metapagedispose">Metapage#dispose</a></li> <li><a href="#metapagegetmetaframe" id="markdown-toc-metapagegetmetaframe">Metapage#getMetaframe</a></li> <li><a href="#metapagegetiframes" id="markdown-toc-metapagegetiframes">Metapage#getIframes</a></li> <li><a href="#metapagegetmetaframeids" id="markdown-toc-metapagegetmetaframeids">Metapage#getMetaframeIds</a></li> <li><a href="#metapagegetmetaframes" id="markdown-toc-metapagegetmetaframes">Metapage#getMetaframes()</a></li> <li><a href="#metapagegetpluginids" id="markdown-toc-metapagegetpluginids">Metapage#getPluginIds</a></li> <li><a href="#metapagegetplugins" id="markdown-toc-metapagegetplugins">Metapage#getPlugins()</a></li> <li><a href="#metapagegetstate" id="markdown-toc-metapagegetstate">Metapage#getState()</a></li> <li><a href="#metapagesetstate" id="markdown-toc-metapagesetstate">Metapage#setState()</a></li> <li><a href="#metapageonstate" id="markdown-toc-metapageonstate">Metapage#onState()</a></li> <li><a href="#metapagesetdefinition" id="markdown-toc-metapagesetdefinition">Metapage#setDefinition()</a></li> <li><a href="#metapagegetdefinition" id="markdown-toc-metapagegetdefinition">Metapage#getDefinition()</a></li> <li><a href="#metapageoninputs" id="markdown-toc-metapageoninputs">Metapage#onInputs</a></li> <li><a href="#metapageonoutputs" id="markdown-toc-metapageonoutputs">Metapage#onOutputs</a></li> <li><a href="#metapageremoveall" id="markdown-toc-metapageremoveall">Metapage#removeAll</a></li> <li><a href="#metapagesetinputsetinputs" id="markdown-toc-metapagesetinputsetinputs">Metapage#setInput/setInputs</a></li> <li><a href="#metapagesetdefinition-1" id="markdown-toc-metapagesetdefinition-1">Metapage#setDefinition</a></li> <li><a href="#metapage-events" id="markdown-toc-metapage-events">Metapage events</a> <ol> <li><a href="#metapagestate" id="markdown-toc-metapagestate">Metapage#STATE</a></li> <li><a href="#metapagedefinition-1" id="markdown-toc-metapagedefinition-1">Metapage#DEFINITION</a></li> <li><a href="#metapageerror" id="markdown-toc-metapageerror">Metapage#ERROR</a></li> </ol> </li> <li><a href="#metapagemetaframeclient" id="markdown-toc-metapagemetaframeclient">Metapage.MetaframeClient</a></li> <li><a href="#metapagemetaframeclienturl" id="markdown-toc-metapagemetaframeclienturl">Metapage.MetaframeClient#?url</a></li> <li><a href="#metapagemetaframeclientiframe" id="markdown-toc-metapagemetaframeclientiframe">Metapage.MetaframeClient#iframe</a></li> <li><a href="#metapagemetaframeclientdispose" id="markdown-toc-metapagemetaframeclientdispose">Metapage.MetaframeClient#dispose</a></li> <li><a href="#metapagemetaframeclientoninputs" id="markdown-toc-metapagemetaframeclientoninputs">Metapage.MetaframeClient#onInputs</a></li> <li><a href="#metapagemetaframeclientonoutputs" id="markdown-toc-metapagemetaframeclientonoutputs">Metapage.MetaframeClient#onOutputs</a></li> </ol> </li> <li><a href="#metaframe" id="markdown-toc-metaframe">Metaframe</a> <ol> <li><a href="#metaframeid" id="markdown-toc-metaframeid">Metaframe#id</a></li> <li><a href="#metaframegetinput" id="markdown-toc-metaframegetinput">Metaframe#getInput</a></li> <li><a href="#metaframegetinputs" id="markdown-toc-metaframegetinputs">Metaframe#getInputs</a></li> <li><a href="#metaframegetoutput" id="markdown-toc-metaframegetoutput">Metaframe#getOutput</a></li> <li><a href="#metaframegetoutputs" id="markdown-toc-metaframegetoutputs">Metaframe#getOutputs</a></li> <li><a href="#metaframeoninputs" id="markdown-toc-metaframeoninputs">Metaframe#onInputs</a></li> <li><a href="#metaframeoninput" id="markdown-toc-metaframeoninput">Metaframe#onInput</a></li> <li><a href="#metaframesetinput" id="markdown-toc-metaframesetinput">Metaframe#setInput</a></li> <li><a href="#metaframesetoutput" id="markdown-toc-metaframesetoutput">Metaframe#setOutput</a></li> <li><a href="#metaframesetoutput-1" id="markdown-toc-metaframesetoutput-1">Metaframe#setOutput</a></li> <li><a href="#metaframedispose" id="markdown-toc-metaframedispose">Metaframe#dispose</a></li> </ol> </li> <li><a href="#plugins" id="markdown-toc-plugins">Plugins</a> <ol> <li><a href="#implenting-a-metapage-plugin" id="markdown-toc-implenting-a-metapage-plugin">Implenting a metapage plugin</a></li> <li><a href="#metaframeplugin" id="markdown-toc-metaframeplugin">Metaframe#plugin</a></li> <li><a href="#metaframepluginrequeststate" id="markdown-toc-metaframepluginrequeststate">Metaframe#plugin.requestState</a></li> <li><a href="#metaframepluginonstate" id="markdown-toc-metaframepluginonstate">Metaframe#plugin.onState</a></li> <li><a href="#metaframepluginsetstate" id="markdown-toc-metaframepluginsetstate">Metaframe#plugin.setState</a></li> <li><a href="#metaframepluginondefinition" id="markdown-toc-metaframepluginondefinition">Metaframe#plugin.onDefinition</a></li> <li><a href="#metaframepluginsetdefinition" id="markdown-toc-metaframepluginsetdefinition">Metaframe#plugin.setDefinition</a></li> <li><a href="#metaframeplugingetdefinition" id="markdown-toc-metaframeplugingetdefinition">Metaframe#plugin.getDefinition</a></li> <li><a href="#metaframeplugin-pipes" id="markdown-toc-metaframeplugin-pipes">Metaframe#plugin pipes</a></li> </ol> </li> </ol> <h2 id="metapagedefinition"> <a href="#metapagedefinition" class="anchor-heading" aria-labelledby="metapagedefinition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> MetapageDefinition<a name="metapagedefinition"></a> </h2> <p>The JSON description consists of metaframes and the metaframe inputs.</p> <p>Example minimal metapage with two metaframes:</p> <div class="language-mermaid">graph LR metaframe1["random-data-generator"] -- "y -&gt; y" --&gt; metaframe2["graph-dynamic"] </div> <p>Defined by:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"layouts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"flexboxgrid"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"docs"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://flexboxgrid.com/"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"layout"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"random-data-generator"</span><span class="p">,</span><span class="w"> </span><span class="nl">"width"</span><span class="p">:</span><span class="s2">"col-xs-4"</span><span class="p">,</span><span class="w"> </span><span class="nl">"style"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nl">"maxHeight"</span><span class="p">:</span><span class="s2">"600px"</span><span class="p">}},</span><span class="w"> </span><span class="p">{</span><span class="nl">"url"</span><span class="p">:</span><span class="s2">"https://metapages.org/metaframes/passthrough-arrow/?rotation=90"</span><span class="p">,</span><span class="w"> </span><span class="nl">"width"</span><span class="p">:</span><span class="s2">"col-xs-1"</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="nl">"name"</span><span class="p">:</span><span class="s2">"graph-dynamic"</span><span class="p">,</span><span class="w"> </span><span class="nl">"width"</span><span class="p">:</span><span class="s2">"col-xs-7"</span><span class="p">}</span><span class="w">  </span><span class="p">]</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"metaframes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"random-data-generator"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://metapages.org/metaframes/random-data-generator/?frequency=1000"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"graph-dynamic"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://metapages.org/metaframes/graph-dynamic/"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"metaframe"</span><span class="p">:</span><span class="w"> </span><span class="s2">"random-data-generator"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"y"</span><span class="p">,</span><span class="w">
          </span><span class="nl">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"y"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"plugins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"https://metapages.org/metaframes/mermaid.js/"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div> <p><a href="https://app.metapages.org/#?url=https://metapages.org/metapages/dynamic-plot/metapage.json" class="btn btn-green">Run above example</a></p> <p>The <code class="language-plaintext highlighter-rouge">pipe</code> entries of “inputs” are objects describing the source metaframe, source metaframe output pipe name, and the target metaframe (the owning metaframe) input pipe name</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">metaframe</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;sourceMetaframeId&gt;</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">source</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;sourceMetaframePipeName&gt;</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">target</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">&lt;thisMetaframePipeName&gt;</span><span class="dl">"</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">pipe.metaframe</code>: source metaframeId</p> <p><code class="language-plaintext highlighter-rouge">pipe.source</code>: source metaframe output pipe name. Can be <code class="language-plaintext highlighter-rouge">*</code> or any glob, this will forward all output pipes matching the glob</p> <p><code class="language-plaintext highlighter-rouge">pipe.target</code>: (optional) target metaframe input pipe name. If <code class="language-plaintext highlighter-rouge">target</code> is omitted, then the input pipe name will be the same as the output pipe name.</p> <div class="language-mermaid">graph LR metaframeSource[pipeInput.metaframe] -- "pipeInput.source -&gt; pipeInput.target" --&gt; targetMetaframe </div> <!-- {: .fs-5 .ls-10 .text-mono .code-example } --> <p><code class="language-plaintext highlighter-rouge">version</code>: This library hasn’t reached version <code class="language-plaintext highlighter-rouge">"1"</code> yet. Backwards compatibility is built into this library from it’s first release, and will be automated as much as possible. This is required to maintain long-term compatibility: metaframes should be useful forever, if that is possible from the content. Users should only need to upgrade for bug fixes, performance improvements, or to access new features, and there should never be cognitive load (no worries) about versioning for library users. Mistakes happen, no process is perfect, but this tool assumes the burden of handling all changes to versions over time.</p><hr /> <h2 id="metapage"> <a href="#metapage" class="anchor-heading" aria-labelledby="metapage"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage </h2> <p>A metapage manages piping metaframe outputs to metaframe inputs.</p> <p>Ways to initialize a metapage:</p> <ol> <li>Load a <code class="language-plaintext highlighter-rouge">metapage.json</code> dynamically and add the metaframes. If no <code class="language-plaintext highlighter-rouge">loadCallback</code> is given, metaframe iframes will automatically be added to the document element with the id that matches the metaframe id: <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">Metapage</span><span class="p">.</span><span class="nx">load</span><span class="p">(?</span><span class="nx">metapage</span> <span class="p">:</span><span class="o">&lt;</span><span class="kr">string</span><span class="o">|</span><span class="nx">object</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">?</span><span class="nx">loadCallback</span> <span class="p">:</span><span class="nx">func</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Metapage</span><span class="o">&gt;</span>
</code></pre></div> </div> <p><br /><code class="language-plaintext highlighter-rouge">metapage</code>: URL to metapage definition, defaults to “metapage.json”, or the metapage JSON object <br /><code class="language-plaintext highlighter-rouge">loadCallback</code>: optional callback with two arguments <code class="language-plaintext highlighter-rouge">(metaframeId, IFrameElement)</code></p> </li> <li>Create a metapage from a <a href="#metapagedefinition">MetapageDefinition</a> JSON object. No metaframes are yet added to the page: <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">metapage</span> <span class="o">=</span> <span class="nx">Metapage</span><span class="p">.</span><span class="k">from</span><span class="p">(</span><span class="nx">def</span> <span class="p">:</span><span class="nx">MetapageDefinition</span><span class="p">,</span> <span class="p">?</span><span class="nx">opts</span> <span class="p">:</span><span class="nx">Options</span><span class="p">):</span> <span class="nx">Metapage</span>
  <span class="c1">// updating the definition</span>
  <span class="nx">metapage</span><span class="p">.</span><span class="nx">setDefinition</span><span class="p">(</span><span class="nx">def</span> <span class="p">:</span><span class="nx">MetapageDefinition</span><span class="p">)</span>
</code></pre></div> </div> </li> </ol> <p>The optional <code class="language-plaintext highlighter-rouge">opts</code> argument defineds some extra options, mostly used for debugging:</p> <div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">Options</span> <span class="p">{</span>
  <span class="nl">color</span><span class="p">?:</span> <span class="nb">String</span><span class="p">;</span>  <span class="c1">// Color of console.logs, since all iframes and the main page will output logs to the same console</span>
  <span class="nl">id</span><span class="p">?</span>   <span class="p">:</span> <span class="nb">String</span><span class="p">;</span>  <span class="c1">// Id, not required, but useful if you have multiple metapages in a single website.</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="metapagesetdebugfromurlparams"> <a href="#metapagesetdebugfromurlparams" class="anchor-heading" aria-labelledby="metapagesetdebugfromurlparams"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#setDebugFromUrlParams </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">setDebugFromUrlParams</span><span class="p">()</span>
</code></pre></div></div> <p>If the URL has one of the parameters <code class="language-plaintext highlighter-rouge">MP_DEBUG</code>, <code class="language-plaintext highlighter-rouge">mp_debug</code>, <code class="language-plaintext highlighter-rouge">DEBUG</code>, <code class="language-plaintext highlighter-rouge">debug</code>, then debug logging is enabled, e.g.: <code class="language-plaintext highlighter-rouge">https://domain.org/metapage1?debug</code>.</p> <p>The metapage and metaframes will output coloured console logs (the color is randomly but deterministically computed from the respective id).</p> <h3 id="metapagedispose"> <a href="#metapagedispose" class="anchor-heading" aria-labelledby="metapagedispose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#dispose </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">dispose</span><span class="p">()</span>
</code></pre></div></div> <p>Removes all metaframes, window listeners, event listeners.</p> <h3 id="metapagegetmetaframe"> <a href="#metapagegetmetaframe" class="anchor-heading" aria-labelledby="metapagegetmetaframe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getMetaframe </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getMetaframe</span><span class="p">(</span><span class="nx">metaframeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">):</span> <span class="nx">MetaframeClient</span>
</code></pre></div></div> <p>Get the MetaframeClient for the given id.</p> <h3 id="metapagegetiframes"> <a href="#metapagegetiframes" class="anchor-heading" aria-labelledby="metapagegetiframes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getIframes </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getIframes</span><span class="p">():</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span> <span class="nx">IFrameElement</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns a plain Object with metaframe ids mapped to the underlying metaframe <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe">iframes</a>.</p> <h3 id="metapagegetmetaframeids"> <a href="#metapagegetmetaframeids" class="anchor-heading" aria-labelledby="metapagegetmetaframeids"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getMetaframeIds </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">metaframeIds</span><span class="p">():</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns an array of metaframe ids.</p> <h3 id="metapagegetmetaframes"> <a href="#metapagegetmetaframes" class="anchor-heading" aria-labelledby="metapagegetmetaframes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getMetaframes() </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getMetaframes</span><span class="p">():</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span> <span class="nx">MetaframeClient</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns a plain Object with metaframe ids mapped to MetaframeClient objects.</p> <h3 id="metapagegetpluginids"> <a href="#metapagegetpluginids" class="anchor-heading" aria-labelledby="metapagegetpluginids"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getPluginIds </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getPluginIds</span><span class="p">():</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nb">String</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns an array of plugin ids.</p> <h3 id="metapagegetplugins"> <a href="#metapagegetplugins" class="anchor-heading" aria-labelledby="metapagegetplugins"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getPlugins() </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getPlugins</span><span class="p">():</span> <span class="nb">Map</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span> <span class="nx">MetaframeClient</span><span class="o">&gt;</span>
</code></pre></div></div> <p>Returns a plain Object with metaframe ids mapped to MetaframeClient objects.</p> <h3 id="metapagegetstate"> <a href="#metapagegetstate" class="anchor-heading" aria-labelledby="metapagegetstate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getState() </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getState</span><span class="p">():</span> <span class="nx">State</span>

</code></pre></div></div> <p>Where <code class="language-plaintext highlighter-rouge">State</code> looks like:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"metaframes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"metaframeId1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"inputPipe1"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>It represents the entire state of the metapage.</p> <h3 id="metapagesetstate"> <a href="#metapagesetstate" class="anchor-heading" aria-labelledby="metapagesetstate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#setState() </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">state</span> <span class="p">:</span><span class="nx">State</span><span class="p">)</span>

</code></pre></div></div> <p>This will update the entire state of the application and set all the metaframe inputs.</p> <h3 id="metapageonstate"> <a href="#metapageonstate" class="anchor-heading" aria-labelledby="metapageonstate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#onState() </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">onState</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">state</span> <span class="p">:</span><span class="nx">State</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>

</code></pre></div></div> <p>The callback is called on every state change.</p> <h3 id="metapagesetdefinition"> <a href="#metapagesetdefinition" class="anchor-heading" aria-labelledby="metapagesetdefinition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#setDefinition() </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">setDefinition</span><span class="p">(</span><span class="nx">def</span> <span class="p">:</span><span class="nx">Definition</span><span class="p">)</span>

</code></pre></div></div> <h3 id="metapagegetdefinition"> <a href="#metapagegetdefinition" class="anchor-heading" aria-labelledby="metapagegetdefinition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#getDefinition() </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">def</span> <span class="p">:</span><span class="nx">Definition</span> <span class="o">=</span> <span class="nx">metapage</span><span class="p">.</span><span class="nx">getDefinition</span><span class="p">();</span>

</code></pre></div></div> <h3 id="metapageoninputs"> <a href="#metapageoninputs" class="anchor-heading" aria-labelledby="metapageoninputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#onInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getMetaframe</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">metaframeId</span><span class="o">&gt;</span><span class="p">).</span><span class="nx">onInputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every input update event. Example <code class="language-plaintext highlighter-rouge">inputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">inputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">getMetaframe</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">metaframeId</span><span class="o">&gt;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>You can also listen on the metaframe clients directly:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h3 id="metapageonoutputs"> <a href="#metapageonoutputs" class="anchor-heading" aria-labelledby="metapageonoutputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#onOutputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">onOutputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every output update event. Example <code class="language-plaintext highlighter-rouge">outputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">outputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h3 id="metapageremoveall"> <a href="#metapageremoveall" class="anchor-heading" aria-labelledby="metapageremoveall"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#removeAll </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">removeAll</span><span class="p">()</span>
</code></pre></div></div> <p>Removes all metaframes, essentially resetting the metapage. It doesn’t remove window listeners though, for proper disposal call <code class="language-plaintext highlighter-rouge">dispose()</code>.</p> <h3 id="metapagesetinputsetinputs"> <a href="#metapagesetinputsetinputs" class="anchor-heading" aria-labelledby="metapagesetinputsetinputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#setInput/setInputs </h3> <p>Set metaframe inputs a variety of ways (there is no difference between <code class="language-plaintext highlighter-rouge">setInput/setInputs</code> calls).</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="nx">metaframeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="nx">inputPipeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="nx">value</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="nx">metaframeId</span> <span class="p">:</span><span class="nb">String</span><span class="p">,</span> <span class="nx">inputsObject</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="nx">metaframeInputsObject</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">inputsObject</code>:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">inputPipeName</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">some value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">metaframeInputsObject</code>:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">metaframeId</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">inputPipeName</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">some value</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="metapagesetdefinition-1"> <a href="#metapagesetdefinition-1" class="anchor-heading" aria-labelledby="metapagesetdefinition-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#setDefinition </h3> <p>Update the metapage definition.</p> <p>This will destroy the current metaframes and plugins, and recreate new ones based on the new definition.</p> <p>The</p> <h3 id="metapage-events"> <a href="#metapage-events" class="anchor-heading" aria-labelledby="metapage-events"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage events </h3> <h4 id="metapagestate"> <a href="#metapagestate" class="anchor-heading" aria-labelledby="metapagestate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#STATE </h4> <p>Metapage event allows you to add hooks to the data flow:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Example update:
 * {
 *   "metaframes": {
 *     "inputs": {
 *        "metaframe1": {
 *          "input1": "foobar",
 *          "input2": 3
 *        }
 *     }
 *   }
 * }
 */</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">state</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">metapageState</span><span class="p">)</span> <span class="p">{</span> <span class="p">...});</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">Metapage</span><span class="p">.</span><span class="nx">STATE</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">definition</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
</code></pre></div></div> <p>Listens to changes in the <code class="language-plaintext highlighter-rouge">state</code> for metaframes (and plugins). The listener is called on every discrete update of inputs and outputs.</p> <h4 id="metapagedefinition-1"> <a href="#metapagedefinition-1" class="anchor-heading" aria-labelledby="metapagedefinition-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#DEFINITION </h4> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * Example definition event:
 * {
 *   "definition": { &lt;MetapageDefinition&gt; },
 *   "metaframes": {
 *     "metaframe1": { "url": "https://metapages.org/metaframes/example1/" },
 *     "metaframe2": { "url": "https://metapages.org/metaframes/example2/" }
 *   },
 *   "plugins": [
 *     { "plugin1": "https://plugin1.io" },
 *     { "plugin2": "https://plugin2.io" }
 *   ]
 * }
 */</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">definition</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">definition</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">Metapage</span><span class="p">.</span><span class="nx">DEFINITION</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">definition</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>

<span class="nx">metapage</span><span class="p">.</span><span class="nx">setDefinition</span><span class="p">(</span><span class="nx">def</span> <span class="p">:</span><span class="nx">MetapageDefinition</span><span class="p">);</span> <span class="c1">// Fires above event</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">getDefinition</span><span class="p">(</span><span class="nx">def</span><span class="p">)</span> <span class="p">:</span><span class="nx">MetapageDefinition</span><span class="p">;</span>
</code></pre></div></div> <p>The definition can be updated, this will fire on every change and give the full definition.</p> <p>It also returns the metaframe and plugin sets, with the objects needed to e.g. add the iframe objects to the DOM.</p> <p>This is the main event you should listen to if your metapage gets updated.</p> <h4 id="metapageerror"> <a href="#metapageerror" class="anchor-heading" aria-labelledby="metapageerror"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage#ERROR </h4> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">definition</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="nx">Metapage</span><span class="p">.</span><span class="nx">ERROR</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">definition</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>

<span class="nx">metapage</span><span class="p">.</span><span class="nx">setDefinition</span><span class="p">(</span><span class="nx">def</span> <span class="p">:</span><span class="nx">MetapageDefinition</span><span class="p">);</span> <span class="c1">// Fires above event</span>
<span class="nx">metapage</span><span class="p">.</span><span class="nx">getDefinition</span><span class="p">(</span><span class="nx">def</span><span class="p">)</span> <span class="p">:</span><span class="nx">MetapageDefinition</span><span class="p">;</span>
</code></pre></div></div> <p>The definition can be updated, this will fire on every change and give the full definition.</p> <h3 id="metapagemetaframeclient"> <a href="#metapagemetaframeclient" class="anchor-heading" aria-labelledby="metapagemetaframeclient"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient </h3> <p>An internal object managing the data flow in and out of the actual metaframe iframe. You shouldn’t need to access this object directly. This object is in the <em>metapage</em> page, managing the metaframe data flow.</p> <h3 id="metapagemetaframeclienturl"> <a href="#metapagemetaframeclienturl" class="anchor-heading" aria-labelledby="metapagemetaframeclienturl"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#?url </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// The URL of the underlying iframe</span>
<span class="kd">const</span> <span class="nx">url</span> <span class="p">:</span><span class="kr">string</span> <span class="o">=</span> <span class="nx">metapage</span><span class="p">.</span><span class="nx">getMetaframe</span><span class="p">(</span><span class="nx">id</span><span class="p">).</span><span class="nx">url</span><span class="p">;</span>
</code></pre></div></div> <h3 id="metapagemetaframeclientiframe"> <a href="#metapagemetaframeclientiframe" class="anchor-heading" aria-labelledby="metapagemetaframeclientiframe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#iframe </h3> <p>The concrete metaframe <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe">iframe</a> HTML element.</p> <h3 id="metapagemetaframeclientdispose"> <a href="#metapagemetaframeclientdispose" class="anchor-heading" aria-labelledby="metapagemetaframeclientdispose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#dispose </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">dispose</span><span class="p">()</span>
</code></pre></div></div> <p>Removes all event listeners and clears internal objects.</p> <h3 id="metapagemetaframeclientoninputs"> <a href="#metapagemetaframeclientoninputs" class="anchor-heading" aria-labelledby="metapagemetaframeclientoninputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#onInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">onInputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every input update event. Example <code class="language-plaintext highlighter-rouge">inputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">inputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h3 id="metapagemetaframeclientonoutputs"> <a href="#metapagemetaframeclientonoutputs" class="anchor-heading" aria-labelledby="metapagemetaframeclientonoutputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metapage.MetaframeClient#onOutputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">onOutputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every output update event. Example <code class="language-plaintext highlighter-rouge">outputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">outputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>An unbind function is returned.</p> <p>The same thing can be called via the event:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metapage</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="nx">metaframeId</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputs</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">outputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <h2 id="metaframe"> <a href="#metaframe" class="anchor-heading" aria-labelledby="metaframe"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe </h2> <p>A metaframe is a website running the metaframe library that adds input+output data pipes to the page.</p> <p>Metaframes optionally have a <code class="language-plaintext highlighter-rouge">metaframe.json</code> definition at the URL path root, defining e.g. name, and the inputs and outputs. The definition is not <em>strictly</em> needed, however is is very helpful. Some metaframes, such as plugins, do require the <code class="language-plaintext highlighter-rouge">metaframe.json</code> to declare what inputs/outputs are allowed.</p> <p>You need to specify a version. All metaframe versions will be compatible with all metapage versions, however some new functionality will obviously not be available with using older versions.</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A button example"</span><span class="p">,</span><span class="w">
		</span><span class="nl">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Dion Whitehead"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="nl">"input_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
			</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="w">
		</span><span class="p">}</span><span class="w">
	</span><span class="p">},</span><span class="w">
	</span><span class="nl">"outputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="nl">"output_name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
			</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="w">
		</span><span class="p">}</span><span class="w">
	</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>Initialize a metaframe:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">metaframe</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Metaframe</span><span class="p">();</span>
</code></pre></div></div> <p>Wait until it has registered and established a connection with the parent <em>metapage</em>:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">await</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">ready</span>
</code></pre></div></div> <p>or:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">ready</span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">_</span><span class="p">)</span> <span class="p">{</span>
	<span class="c1">//Do something, set inputs/outputs</span>
<span class="p">});</span>
</code></pre></div></div> <h3 id="metaframeid"> <a href="#metaframeid" class="anchor-heading" aria-labelledby="metaframeid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#id </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">s</span> <span class="p">:</span><span class="nb">String</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
</code></pre></div></div> <p>The id the metapage assigned to this metaframe. Defaults to the key in the metapage definition.</p> <h3 id="metaframegetinput"> <a href="#metaframegetinput" class="anchor-heading" aria-labelledby="metaframegetinput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getInput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">inputValue</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getInput</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputName</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div> <h3 id="metaframegetinputs"> <a href="#metaframegetinputs" class="anchor-heading" aria-labelledby="metaframegetinputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">inputValues</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getInputs</span><span class="p">()</span>
</code></pre></div></div> <p>Get a object of input pipe names mapped to values.</p> <p>Do not modify the returned object! For efficiency purposes this is <em>not</em> a copy.</p> <h3 id="metaframegetoutput"> <a href="#metaframegetoutput" class="anchor-heading" aria-labelledby="metaframegetoutput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getOutput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">output</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getOutput</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputName</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div> <h3 id="metaframegetoutputs"> <a href="#metaframegetoutputs" class="anchor-heading" aria-labelledby="metaframegetoutputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#getOutputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">outputs</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">getOutputs</span><span class="p">()</span>
</code></pre></div></div> <p>Do not modify the returned object! For efficiency purposes this is <em>not</em> a copy.</p> <h3 id="metaframeoninputs"> <a href="#metaframeoninputs" class="anchor-heading" aria-labelledby="metaframeoninputs"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#onInputs </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">onInputs</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">inputs</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>Callback called on every input update event. Example <code class="language-plaintext highlighter-rouge">inputs</code> payload:</p> <div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">inputPipeId1</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div> <p>Do not modify the returned object! For efficiency purposes this is <em>not</em> a copy.</p> <p>An unbind function is returned.</p> <h3 id="metaframeoninput"> <a href="#metaframeoninput" class="anchor-heading" aria-labelledby="metaframeoninput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#onInput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">onInput</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputName</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{...}):</span> <span class="kd">function</span><span class="p">():</span>
</code></pre></div></div> <p>The callback will fire with the value of the input pipe on every update.</p> <p>An unbind function is returned.</p> <h3 id="metaframesetinput"> <a href="#metaframesetinput" class="anchor-heading" aria-labelledby="metaframesetinput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#setInput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">setInput</span><span class="p">(</span><span class="dl">'</span><span class="s1">inputName</span><span class="dl">'</span><span class="p">,</span> <span class="nx">value</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
</code></pre></div></div> <h3 id="metaframesetoutput"> <a href="#metaframesetoutput" class="anchor-heading" aria-labelledby="metaframesetoutput"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#setOutput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">setOutput</span><span class="p">(</span><span class="dl">'</span><span class="s1">outputName</span><span class="dl">'</span><span class="p">,</span> <span class="nx">value</span> <span class="p">:</span><span class="kr">any</span><span class="p">)</span>
</code></pre></div></div> <p>This value will be send to all downstream metaframe consumers.</p> <h3 id="metaframesetoutput-1"> <a href="#metaframesetoutput-1" class="anchor-heading" aria-labelledby="metaframesetoutput-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#setOutput </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">setOutputs</span><span class="p">(</span><span class="nx">values</span> <span class="p">:</span><span class="nb">Object</span><span class="p">)</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">values</code>: object mapping output names to values.</p> <p>These values will be send to all downstream metaframe consumers.</p> <h3 id="metaframedispose"> <a href="#metaframedispose" class="anchor-heading" aria-labelledby="metaframedispose"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#dispose </h3> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">dispose</span><span class="p">()</span>
</code></pre></div></div> <p>Removes window message listener, event listeners, and nulls potentially large fields.</p> <h1 id="plugins"> <a href="#plugins" class="anchor-heading" aria-labelledby="plugins"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Plugins </h1> <p>Metapage plugins are metaframes that are not connected to the normal metaframes, instead they have hooks (via inputs) into:</p> <ul> <li>metapage state changes (the metaframe inputs + outputs)</li> <li>the metapage definition</li> </ul> <p>Uses for the above include:</p> <ul> <li>saving and restoring state changes</li> <li>displaying representations of the definition (graph views, JSON editors)</li> <li>others things currently outside my imagination</li> </ul> <p>They are defined in the definition as unique URL to the plugin metaframe:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"metaframes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">...</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"plugins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"https://plugin1.io"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"https://plugin2.io?param1=value1"</span><span class="w">
    </span><span class="p">]</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>The order of the plugins is usually the order displayed in the <a href="https://app.metapages.org">app.metapages.org</a> UI.</p> <p>The plugin URLs must be unique (even though they are defined in a list) and are not allowed to collide with the metaframe ids.</p> <h2 id="implenting-a-metapage-plugin"> <a href="#implenting-a-metapage-plugin" class="anchor-heading" aria-labelledby="implenting-a-metapage-plugin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Implenting a metapage plugin </h2> <p>Plugins declare which inputs they are allows to receive in the <code class="language-plaintext highlighter-rouge">metaframe.json</code> definition located at the base of the URL path. The outputs declare which values they will emit. All supported values are in this example plugin metaframe definition:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
	</span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w">
	</span><span class="nl">"metadata"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"My metapage plugin"</span><span class="w">
	</span><span class="p">},</span><span class="w">
	</span><span class="nl">"inputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="nl">"metapage/state"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
			</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"metapage/definition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
			</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="w">
		</span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"outputs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="nl">"metapage/state"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
			</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"metapage/definition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
			</span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"json"</span><span class="w">
		</span><span class="p">}</span><span class="w">
	</span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="metaframeplugin"> <a href="#metaframeplugin" class="anchor-heading" aria-labelledby="metaframeplugin"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin </h2> <p>The <code class="language-plaintext highlighter-rouge">plugin</code> field on the <code class="language-plaintext highlighter-rouge">metapage</code> object will be present if the metaframe is initialized as a plugin by the owning metapage:</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">plugin</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">metapage/definition</code> and <code class="language-plaintext highlighter-rouge">metapage/state</code> pipes may be listened to as per usual, or you may call the plugin methods:</p> <h2 id="metaframepluginrequeststate"> <a href="#metaframepluginrequeststate" class="anchor-heading" aria-labelledby="metaframepluginrequeststate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin.requestState </h2> <h2 id="metaframepluginonstate"> <a href="#metaframepluginonstate" class="anchor-heading" aria-labelledby="metaframepluginonstate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin.onState </h2> <p>Requests the current state from the metapage.</p> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">plugin</span><span class="p">.</span><span class="nx">requestState</span><span class="p">();</span> <span class="c1">// arrives via the next line</span>
<span class="kd">var</span> <span class="nx">disposeFunction</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">plugin</span><span class="p">.</span><span class="nx">onState</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">metapageState</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>

</code></pre></div></div> <h2 id="metaframepluginsetstate"> <a href="#metaframepluginsetstate" class="anchor-heading" aria-labelledby="metaframepluginsetstate"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin.setState </h2> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">metaframe</span><span class="p">.</span><span class="nx">plugin</span><span class="p">.</span><span class="nx">setState</span><span class="p">(</span><span class="nx">metapageState</span><span class="p">);</span>
</code></pre></div></div> <h2 id="metaframepluginondefinition"> <a href="#metaframepluginondefinition" class="anchor-heading" aria-labelledby="metaframepluginondefinition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin.onDefinition </h2> <h2 id="metaframepluginsetdefinition"> <a href="#metaframepluginsetdefinition" class="anchor-heading" aria-labelledby="metaframepluginsetdefinition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin.setDefinition </h2> <h2 id="metaframeplugingetdefinition"> <a href="#metaframeplugingetdefinition" class="anchor-heading" aria-labelledby="metaframeplugingetdefinition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin.getDefinition </h2> <div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">disposeFunction</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">plugin</span><span class="p">.</span><span class="nx">onDefinition</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">metapageDefinition</span><span class="p">)</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>
<span class="nx">metaframe</span><span class="p">.</span><span class="nx">plugin</span><span class="p">.</span><span class="nx">setDefinition</span><span class="p">(</span><span class="nx">metapageDefinition</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">definition</span> <span class="o">=</span> <span class="nx">metaframe</span><span class="p">.</span><span class="nx">plugin</span><span class="p">.</span><span class="nx">getDefinition</span><span class="p">);</span>
</code></pre></div></div> <h2 id="metaframeplugin-pipes"> <a href="#metaframeplugin-pipes" class="anchor-heading" aria-labelledby="metaframeplugin-pipes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metaframe#plugin pipes </h2> <p><code class="language-plaintext highlighter-rouge">metapage/definition</code>: this input will always have the most recent metapage definition. If the output is set, the metapage will update the definition. No action is needed to get this data.</p> <p><code class="language-plaintext highlighter-rouge">metapage/state</code>: this input has the metapage state. If the output is set, the metapage will update the entire application state. The <code class="language-plaintext highlighter-rouge">metapage/state</code> is not sent automatically, it must be requested every time:</p> </div> </div> </div> </body> </html>
