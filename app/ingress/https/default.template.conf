# default.conf is AUTOGENERATED


# Just terminate TLS and forward requests
server {
  listen $APP_PORT ssl http2;
  listen [::]:$APP_PORT ssl; # IPv6 support
  server_name $APP_FQDN;

  # Comment this out to see access logs
  access_log  /dev/null;

  ssl_certificate /etc/nginx/conf.d/certs/$APP_FQDN.pem;
  ssl_certificate_key /etc/nginx/conf.d/certs/$APP_FQDN-key.pem;

  location = /docs {
    return 301 /docs/;
  }

  location /docs/ {
    proxy_pass http://docs:$APP_PORT/docs/;
    proxy_set_header Host $http_host;
  }

  location / {
    # proxy_pass http://tests-server:$TEST_SERVER_PORT;
    proxy_pass http://libs:$TEST_SERVER_PORT;
    proxy_set_header Host $http_host;
  }

  location = /favicon.ico {
    return 204;
    access_log off;
    log_not_found off;
  }
}
